# П.34. Канал \- Тайм\-аут

Метод тайм\-аута канала используется для управления приемом данных из канала, относящихся к моменту получения данных, с интервалом тайм\-аута, который мы можем установить сами.

Если в течение указанной длительности нет действия по приему данных, выполняется тайм\-аут блока.

## A.34.1. Применение тайм\-аутов канала

Ниже приведен простой программный пример применения тайм\-аута на канале. Новая процедура запускается с задачей отправки данных через определенные интервалы, причем длительность самого интервала является случайной.

```
package main

import "fmt"
import "math/rand"
import "runtime"
import "time"

func sendData(ch chan<- int) {
    for i := 0; true; i++ {
        ch <- i
        time.Sleep(time.Duration(rand.Int()%10+1) * time.Second)
    }
}

```

Затем цикл устанавливается без прерывания, в котором в каждом цикле выполняется выбор условий с использованием канала `select` .

```
func retreiveData(ch <-chan int) {
    loop:
    for {
        select {
        case data := <-ch:
            fmt.Print(`receive data "`, data, `"`, "\n")
        case <-time.After(time.Second * 5):
            fmt.Println("timeout. no activities under 5 seconds")
            break loop
        }
    }
}

```

На это есть 2 блока условий `select` .

*   Условия `case data := <-messages:` будут выполнены при передаче данных по каналу `messages` .
*   Условия `case <-time.After(time.Second * 5):` будут выполнены, если в течение 5 секунд не будет активности получения данных из канала. Этот блок является тем, что мы называем блоком тайм\-аута.

Наконец, обе функции вызываются в `main()` .

```
func main() {
    rand.Seed(time.Now().Unix())
    runtime.GOMAXPROCS(2)

    var messages = make(chan int)

    go sendData(messages)
    retreiveData(messages)
}

```

Выход появляется всякий раз, когда происходит прием данных со случайной временной задержкой. Когда в течение 5 секунд не поступает активность от канала, цикл проверки канала останавливается.

![Тайм-аут канала](https://dasarpemrogramangolang.novalagung.com/images/A.34_1_channel_delay.png)
